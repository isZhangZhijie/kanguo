require("../../../common/manifest.js");
require("../../../common/vendor.js");
global.webpackJsonp([10],{132:function(t,e,i){"use strict";var a=o(i(1)),s=o(i(133));function o(t){return t&&t.__esModule?t:{default:t}}Page((0,a.default)(s.default))},133:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i(135),s=i.n(a),o=i(136),n=!1;var c=function(t){n||i(134)},r=i(0)(s.a,o.a,c,null,null);r.options.__file="D:\\myProject\\kanguoApp\\kanguo\\pages\\wode\\bianji\\bianji.vue",r.esModule&&Object.keys(r.esModule).some(function(t){return"default"!==t&&"__"!==t.substr(0,2)})&&console.error("named exports are not supported in *.vue files."),r.options.functional&&console.error("[vue-loader] bianji.vue: functional components are not supported with templates, they should use render functions."),e.default=r.exports},134:function(t,e){},135:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var i=t.getSystemInfoSync(),a=i.screenWidth,s=void 0,o=void 0,n=(i.pixelRatio,void 0),c=void 0,r=void 0,u=void 0,p=void 0,l=void 0,h=void 0,d=100,g=i.screenWidth;e.default={data:function(){return{name:"张志杰",imageSrc:"",isShowImg:!1,cropperInitW:a,cropperInitH:a,cropperW:a,cropperH:a,cropperL:0,cropperT:0,transL:0,transT:0,scaleP:0,imageW:0,imageH:0,cutL:0,cutT:0,cutB:a,cutR:"100%",qualityWidth:g,innerAspectRadio:1,userData:"",head_img:"",nickname:"",signature:"欢迎来到看过~",sex:""}},onLoad:function(t){console.log(t.userData),this.userData=JSON.parse(t.userData),this.head_img=this.userData.head_img,this.nickname=this.userData.nickname,this.signature=this.userData.signature,this.sex=this.userData.sex},mounted:function(){},methods:{setData:function(t){var e=this;Object.keys(t).forEach(function(i){e.$set(e.$data,i,t[i])})},getImage:function(){var e=this;t.chooseImage({success:function(t){e.setData({imageSrc:t.tempFilePaths[0]}),e.loadImage()}})},loadImage:function(){var e=this;t.showLoading({title:"图片加载中..."}),t.getImageInfo({src:e.imageSrc,success:function(i){(p=i.width/i.height)>=1?(l=a,h=a/p):(l=a*p,h=a);var s=l>h?l:h;if(d=s>d?d:s,p>=1){var o=Math.ceil((l-h)/2),n=o;e.setData({cropperW:a,cropperH:a/p,cropperL:Math.ceil((a-a)/2),cropperT:Math.ceil((a-a/p)/2),cutL:o,cutT:0,cutR:n,cutB:0,imageW:l,imageH:h,scaleP:l/a,qualityWidth:g,innerAspectRadio:p})}else{var c=Math.ceil((h-l)/2),r=c;e.setData({cropperW:a*p,cropperH:a,cropperL:Math.ceil((a-a*p)/2),cropperT:Math.ceil((a-a)/2),cutL:0,cutT:c,cutR:0,cutB:r,imageW:l,imageH:h,scaleP:l/a,qualityWidth:g,innerAspectRadio:p})}e.setData({isShowImg:!0}),t.hideLoading()}})},contentStartMove:function(t){s=t.touches[0].pageX,o=t.touches[0].pageY},contentMoveing:function(t){var e=1*(s-t.touches[0].pageX),i=1*(o-t.touches[0].pageY);e>0?this.cutL-e<0&&(e=this.cutL):this.cutR+e<0&&(e=-this.cutR),i>0?this.cutT-i<0&&(i=this.cutT):this.cutB+i<0&&(i=-this.cutB),this.setData({cutL:this.cutL-e,cutT:this.cutT-i,cutR:this.cutR+e,cutB:this.cutB+i}),s=t.touches[0].pageX,o=t.touches[0].pageY},contentTouchEnd:function(){},getImageInfo:function(){var e=this;t.showLoading({title:"图片生成中..."});var i=t.createCanvasContext("myCanvas");i.drawImage(e.imageSrc,0,0,l,h),i.draw(!0,function(){var i=(e.cropperW-e.cutL-e.cutR)/e.cropperW*l,a=(e.cropperH-e.cutT-e.cutB)/e.cropperH*h,s=e.cutL/e.cropperW*l,o=e.cutT/e.cropperH*h;t.canvasToTempFilePath({x:s,y:o,width:i,height:a,destWidth:i,destHeight:a,quality:.5,canvasId:"myCanvas",success:function(i){t.hideLoading(),e.setData({isShowImg:!1,head_img:i.tempFilePath})}})})},dragStart:function(t){n=t.touches[0].pageX,c=t.touches[0].pageY,this.cutL,r=this.cutR,u=this.cutB,this.cutT},dragMove:function(t){t.target.dataset.drag;var e=1*(n-t.touches[0].pageX),i=1*(c-t.touches[0].pageY);Math.abs(e)>=Math.abs(i)&&(i=e),Math.abs(e)<Math.abs(i)&&(e=i);var a=Math.abs(e)>=Math.abs(i)?e:i;u+i<0&&(a=-u),r+e<0&&(a=-r);var s=u+a,o=r+a;this.setData({cutB:s,cutR:o})},radioChange:function(t){console.log("radio发生change事件，携带value值为："+t.detail.value),this.sex=t.detail.value},finish:function(){console.log(this.head_img),console.log(this.nickname),console.log(this.signature),console.log(this.sex),t.request({url:"http://www.aikm.cn/api/edit/personal/data",method:"POST",data:{uid:this.userData.id,token:this.userData.token,head_img:this.head_img,nickname:this.nickname,sex:this.sex,signature:this.signature},success:function(t){console.log(JSON.stringify(t.data))},fail:function(){},complete:function(){}})}}}}).call(e,i(2).default)},136:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("view",{staticClass:"container"},[i("view",{staticClass:"page-body uni-content-info"},[i("view",{staticClass:"avatar"},[i("image",{attrs:{src:t.head_img,mode:"widthFix",eventid:"WRj-0"},on:{click:t.getImage}})]),i("view",{staticClass:"input-box"},[i("text",[t._v("昵称：")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.nickname,expression:"nickname"}],attrs:{type:"text",maxlength:"12",placeholder:"12字以内",eventid:"33T-1"},domProps:{value:t.nickname},on:{input:function(e){e.target.composing||(t.nickname=e.target.value)}}})]),i("view",{staticClass:"input-box"},[i("text",[t._v("个性签名：")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.signature,expression:"signature"}],attrs:{type:"text",maxlength:"20",placeholder:"20字以内",eventid:"d1V-2"},domProps:{value:t.signature},on:{input:function(e){e.target.composing||(t.signature=e.target.value)}}})]),i("view",{staticClass:"input-box"},[i("text",[t._v("性别：")]),i("radio-group",{staticClass:"radio-group",attrs:{mpcomid:"mTs-0"}},[i("label",{staticClass:"radio"},[i("radio",{attrs:{value:"2",color:"#feda46",eventid:"2W0-3"},model:{value:t.sex,callback:function(e){t.sex=e},expression:"sex"}}),t._v("女\n\t\t\t\t")],1),i("label",{staticClass:"radio"},[i("radio",{attrs:{value:"1",color:"#feda46",eventid:"D88-4"},model:{value:t.sex,callback:function(e){t.sex=e},expression:"sex"}}),t._v("男\n\t\t\t\t")],1)],1)],1),i("view",{staticClass:"finish-btn",attrs:{eventid:"5EH-5"},on:{tap:t.finish}},[t._v("完成")]),t.isShowImg?i("view",{staticClass:"cropper-content"},[i("view",{staticClass:"uni-corpper",style:"width:"+t.cropperInitW+"px;height:"+t.cropperInitH+"px;background:#000"},[i("view",{staticClass:"uni-corpper-content",style:"width:"+t.cropperW+"px;height:"+t.cropperH+"px;left:"+t.cropperL+"px;top:"+t.cropperT+"px"},[i("image",{style:"width:"+t.cropperW+"px;height:"+t.cropperH+"px",attrs:{src:t.imageSrc}}),i("view",{staticClass:"uni-corpper-crop-box",style:"left:"+t.cutL+"px;top:"+t.cutT+"px;right:"+t.cutR+"px;bottom:"+t.cutB+"px",attrs:{eventid:"eRh-7"},on:{touchstart:function(e){e.stopPropagation(),t.contentStartMove(e)},touchmove:function(e){e.stopPropagation(),t.contentMoveing(e)},touchend:function(e){e.stopPropagation(),t.contentTouchEnd(e)}}},[i("view",{staticClass:"uni-cropper-view-box"},[i("view",{staticClass:"uni-cropper-dashed-h"}),i("view",{staticClass:"uni-cropper-dashed-v"}),i("view",{staticClass:"uni-cropper-line-t"}),i("view",{staticClass:"uni-cropper-line-r"}),i("view",{staticClass:"uni-cropper-line-b"}),i("view",{staticClass:"uni-cropper-line-l"}),i("view",{staticClass:"uni-cropper-point point-t"}),i("view",{staticClass:"uni-cropper-point point-tr"}),i("view",{staticClass:"uni-cropper-point point-r"}),i("view",{staticClass:"uni-cropper-point point-rb",attrs:{"data-drag":"rightBottom",eventid:"fXX-6"},on:{touchstart:function(e){e.stopPropagation(),t.dragStart(e)},touchmove:function(e){e.stopPropagation(),t.dragMove(e)}}}),i("view",{staticClass:"uni-cropper-point point-b"}),i("view",{staticClass:"uni-cropper-point point-bl"}),i("view",{staticClass:"uni-cropper-point point-l"}),i("view",{staticClass:"uni-cropper-point point-lt"})])])])]),i("view",{staticClass:"cropper-config"},[i("button",{staticStyle:{"margin-top":"30upx"},attrs:{eventid:"sUb-8"},on:{click:t.getImageInfo}},[t._v(" 点击生成头像 ")])],1)]):t._e(),i("canvas",{style:"position:absolute;border: 1px solid red; width:"+t.imageW+"px;height:"+t.imageH+"px;top:-9999px;left:-9999px;",attrs:{"canvas-id":"myCanvas"}})])])};a._withStripped=!0;var s={render:a,staticRenderFns:[]};e.a=s}},[132]);
//# sourceMappingURL=../../../../.sourcemap/mp-weixin/pages/wode/bianji/bianji.js.map